{
    "name": "dubbing-worker",
    "main": "src/index.ts",
    "compatibility_date": "2026-02-14",
    // Pipeline ใช้เวลา 2-3 นาที
    "limits": {
        "cpu_ms": 300000
    },
    // Container: FFmpeg merge service
    "containers": [
        {
            "class_name": "MergeContainer",
            "image": "../merge/Dockerfile",
            "instance_type": "basic",
            "max_instances": 2
        }
    ],
    // Durable Objects (Container = DO)
    "durable_objects": {
        "bindings": [
            {
                "name": "MERGE_CONTAINER",
                "class_name": "MergeContainer"
            }
        ]
    },
    // DO migrations
    "migrations": [
        {
            "tag": "v1",
            "new_sqlite_classes": [
                "MergeContainer"
            ]
        }
    ],
    // D1 Database
    "d1_databases": [
        {
            "binding": "DB",
            "database_name": "dubbing-db",
            "database_id": "af814a17-2bf8-46f7-a73a-7a52c4830822"
        }
    ],
    // R2 Bucket
    "r2_buckets": [
        {
            "binding": "BUCKET",
            "bucket_name": "dubbing-videos"
        }
    ],
    // Environment variables
    "vars": {
        "CORS_ORIGIN": "*",
        "R2_PUBLIC_URL": "https://pub-a706e0103203445680507a4f55084d86.r2.dev",
        "GEMINI_MODEL": "gemini-3-flash-preview"
    },
    // Secrets (set via `wrangler secret put`):
    // GOOGLE_API_KEY
    // TELEGRAM_BOT_TOKEN
    // Cron trigger for auto-posting to Facebook Reels
    "triggers": {
        "crons": [
            "* * * * *"
        ]
    }
}